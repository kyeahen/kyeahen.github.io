---
title: '[BOJ] 9250 ë¬¸ìì—´ ì§‘í•© íŒë³„'
categories:
  - Algorithm
tags:
  - Java
  - String
  - BOJ

comments: true 
---
### ì•„í˜¸-ì½”ë¼ì‹ ì˜ˆì œ

## ë¬¸ì œ
<a href = "https://www.acmicpc.net/problem/9250"> https://www.acmicpc.net/problem/9250 </a>
<br/>

## ë¬¸ì œ í’€ì´

``` java
package Baekjoon.String;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.LinkedList;
import java.util.Queue;

/**
 * Created by kyeahen.
 * Title : 9250 ë¬¸ìì—´ì§‘í•©íŒë³„
 * Category : ì•„í˜¸-ì½”ë¼ì‹
 * Date: 2021/02/17

 * ref - https://hellogaon.tistory.com/17
       - https://blog.naver.com/kerochuu/222035299045
 */

public class BJ_9250 {

    private static class Node {
        boolean isEnd, isRoot;
        Node[] child; //ìì‹ ë…¸ë“œ
        Node fail; //ì´ ë…¸ë“œì—ì„œ ë§¤ì¹­ì´ ì‹¤íŒ¨í–ˆì„ ë•Œ, ë‹¤ìŒìœ¼ë¡œ ê°€ì„œ ì‹œë„í•´ì•¼í•  ë…¸ë“œì˜ í¬ì¸í„°

        Node(boolean isRoot) {
            child = new Node[size];
            this.isRoot = isRoot;
        }

        Node setChild(char data) {
            if (child[data - 'a'] == null) { //í•´ë‹¹ ìì‹ ë…¸ë“œê°€ ì—†ìœ¼ë©´
                return child[data - 'a'] = new Node(false); //ìì‹ ë…¸ë“œ ìƒì„±
            }

            return child[data - 'a'];
        }
    }

    private static class Tries {
        Node root = new Node(true); // true = root

        void add(String s) {
            Node n = root;

            for (int i = 0; i< s.length(); i++) {
                n = n.setChild(s.charAt(i));
            }

            n.isEnd = true;
        }
    }

    static int N;
    static int size = 26;

    static Tries tries = new Tries();
    static Queue<Node> q = new LinkedList<>();
    static StringBuilder sb = new StringBuilder();

    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

        N = Integer.parseInt(br.readLine());

        for (int i = 0; i < N; i++) {
            tries.add(br.readLine());
        }

        //bfs êµ¬í˜„ (kmp ì „ì²˜ë¦¬)
        init_bfs();
        bfs();

        //kmp
        N = Integer.parseInt(br.readLine());

        for (int i = 0; i < N; i++) {

            if (kmp(br.readLine(), tries.root)) { //ì§‘í•©ì— ì†í•˜ë©´
                sb.append("YES" + "\n");
            } else {
                sb.append("NO" + "\n");
            }
        }

        System.out.print(sb.toString());
    }

    public static void init_bfs() {
        tries.root.fail = tries.root; //ë£¨íŠ¸ì˜ fail í•¨ìˆ˜ëŠ” ìê¸° ìì‹ 
        q.add(tries.root); //ë£¨íŠ¸ ë…¸ë“œ ì¶”ê°€
    }

    // Failure Link (ì‹¤íŒ¨ ì—°ê²°)
    public static void bfs() {

        // * trieì˜ ë£¨íŠ¸ ë…¸ë“œë¡œë¶€í„° bfsë¥¼ ìˆ˜í•´í•˜ë©´ì„œ ì‹¤íŒ¨ ì—°ê²°ì„ ë§Œë“ ë‹¤. *

        while (!q.isEmpty()) {
            Node node = q.poll();

            for (int i = 0; i < size; i++) {
                Node child = node.child[i]; //í˜„ì¬ ë…¸ë“œì˜ ìì‹ ë…¸ë“œ (ì•ŒíŒŒë²³)

                if (child != null) { //í•´ë‹¹ ì•ŒíŒŒë²³ì´ ì—†ìœ¼ë©´

                    if (node.isRoot) { // ë£¨íŠ¸ ë…¸ë“œì´ë©´
                        child.fail = tries.root; //childì˜ ì‹¤íŒ¨ ì—°ê²°ì€ ë£¨íŠ¸

                        // - 1ë ˆë²¨ ë…¸ë“œì˜ ì‹¤íŒ¨ ì—°ê²°ì€ í•­ìƒ ë£¨íŠ¸
                        // - rootì˜ ë‹¤ìŒ depthê¹Œì§€ failì€ rootë¥¼ ê°€ë¦¬í‚´

                    } else { //ë£¨íŠ¸ ë…¸ë“œê°€ ì•„ë‹ˆë©´
                        Node failure = node.fail; //nodeì˜ ì‹¤íŒ¨ ì—°ê²°

                        // * ì‹¤íŒ¨ ë§í¬ì—ì„œ childì™€ ê°™ì€ ë¬¸ìë¡œ ì´ì–´ì§€ëŠ” ìì‹ ë…¸ë“œê°€ ìˆëŠ”ì§€ ì°¾ê¸° *

                        while (!failure.isRoot && failure.child[i] == null) { //ë£¨íŠ¸ ë…¸ë“œê°€ ì•„ë‹ˆê³ , ìì‹ ë…¸ë“œê°€ nullì¼ ë™ì•ˆ
                            failure = failure.fail; //ì°¾ì§€ ëª»í–ˆìœ¼ë©´, "ì‹¤íŒ¨ ì—°ê²°" ëŒ€ì…
                        }

                        if (failure.child[i] != null) { //ìì‹ ë…¸ë“œê°€ nullì´ ì•„ë‹ˆë©´
                            failure = failure.child[i]; //ì°¾ìœ¼ë©´, í•´ë‹¹ "ìì‹ ë…¸ë“œ" ëŒ€ì…
                        }

                        child.fail = failure;
                    }

                    if (child.fail.isEnd) { //ëª¨ë‘ íƒìƒ‰í–ˆìœ¼ë©´
                        child.isEnd = true;
                    }

                    q.add(child);
                }
            }
        }
    }

    public static boolean kmp(String input, Node n) {
        Node node = n; //ê·¸ëƒ¥ n ê°€ì ¸ë‹¤ì“°ë©´ tries.root ê°’ ë³€í•¨ (call by ref)

        for (int i = 0; i < input.length(); i++) {
            int current = input.charAt(i) - 'a';

            // * currentì™€ ê°™ì€ ë¬¸ìë¡œ ì´ì–´ì§€ëŠ” ìì‹ ë…¸ë“œê°€ ìˆëŠ”ì§€ ì°¾ê¸° *

            //ì°¾ì§€ ëª»í–ˆìœ¼ë©´, "ì‹¤íŒ¨ ì—°ê²°" ëŒ€ì…
            while (!node.isRoot && node.child[current] == null) {
                node = node.fail;
            }

            //ì°¾ìœ¼ë©´, í•´ë‹¹ "ìì‹ ë…¸ë“œ" ëŒ€ì…
            if (node.child[current] != null) {
                node = node.child[current];
            }

            if (node.isEnd) { //ëª¨ë‘ íƒìƒ‰í–ˆìœ¼ë©´
                return true;
            }

        }

        return false;
    }
}
```

## TMI

**21/04/14: ì•Œê³ ë¦¬ì¦˜ ìŠ¤í„°ë”” ë¬¸ì œ í’€ì´ğŸ¤“**
